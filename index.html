<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BotCreator - Конструктор Telegram-ботов</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #0088cc;
            --primary-dark: #006699;
            --secondary-color: #6c757d;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --bg-color: #f5f7fb;
            --card-color: #ffffff;
            --border-color: #eaeaea;
            --text-color: #333333;
            --text-secondary: #666666;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --transition: all 0.3s ease;
        }

        .dark-theme {
            --bg-color: #121212;
            --card-color: #1e1e1e;
            --border-color: #333333;
            --text-color: #f0f0f0;
            --text-secondary: #aaaaaa;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: var(--transition);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header & Navigation */
        header {
            background-color: var(--card-color);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .logo i {
            margin-right: 10px;
            font-size: 2rem;
        }

        .nav-links {
            display: flex;
            gap: 25px;
            align-items: center;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--text-color);
            font-weight: 500;
            transition: var(--transition);
        }

        .nav-links a:hover {
            color: var(--primary-color);
        }

        .btn {
            display: inline-block;
            padding: 10px 24px;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            cursor: pointer;
            border: none;
            transition: var(--transition);
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-outline {
            background-color: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-outline:hover {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-success {
            background-color: var(--success-color);
            color: white;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.9rem;
        }

        /* Hero Section */
        .hero {
            padding: 80px 0;
            text-align: center;
        }

        .hero h1 {
            font-size: 2.8rem;
            margin-bottom: 20px;
            color: var(--text-color);
        }

        .hero p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 40px;
            color: var(--text-secondary);
        }

        .hero-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        /* Dashboard */
        .dashboard {
            display: none;
            padding: 40px 0;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .dashboard-title {
            font-size: 1.8rem;
            color: var(--text-color);
        }

        /* Sidebar & Main Content */
        .dashboard-content {
            display: flex;
            gap: 30px;
        }

        .sidebar {
            width: 250px;
            background-color: var(--card-color);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            height: fit-content;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 10px;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            text-decoration: none;
            color: var(--text-color);
            border-radius: 8px;
            transition: var(--transition);
        }

        .sidebar-menu a i {
            margin-right: 10px;
            width: 20px;
        }

        .sidebar-menu a:hover, .sidebar-menu a.active {
            background-color: rgba(0, 136, 204, 0.1);
            color: var(--primary-color);
        }

        .main-content {
            flex: 1;
        }

        /* Bot List */
        .bot-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .bot-card {
            background-color: var(--card-color);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        .bot-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }

        .bot-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .bot-name {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-color);
        }

        .bot-status {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .bot-status.active {
            background-color: var(--success-color);
        }

        .bot-status.inactive {
            background-color: var(--secondary-color);
        }

        .bot-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        /* Bot Constructor */
        .constructor {
            display: none;
        }

        .constructor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .constructor-title {
            font-size: 1.5rem;
            color: var(--text-color);
        }

        .constructor-layout {
            display: flex;
            gap: 20px;
            height: 70vh;
        }

        .components-panel {
            width: 250px;
            background-color: var(--card-color);
            border-radius: 12px;
            padding: 15px;
            box-shadow: var(--shadow);
            overflow-y: auto;
        }

        .component-category {
            margin-bottom: 20px;
        }

        .component-category h4 {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--text-color);
            padding-bottom: 5px;
            border-bottom: 1px solid var(--border-color);
        }

        .component-item {
            background-color: var(--bg-color);
            padding: 10px 15px;
            margin-bottom: 8px;
            border-radius: 8px;
            cursor: move;
            transition: var(--transition);
            border: 1px solid transparent;
        }

        .component-item:hover {
            border-color: var(--primary-color);
            background-color: rgba(0, 136, 204, 0.05);
        }

        .workspace {
            flex: 1;
            background-color: var(--card-color);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            overflow-y: auto;
        }

        .workspace-placeholder {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            color: var(--text-secondary);
            text-align: center;
        }

        .workspace-placeholder i {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            opacity: 0.5;
        }

        .preview-panel {
            width: 300px;
            background-color: var(--card-color);
            border-radius: 12px;
            padding: 15px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
        }

        .preview-title {
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: var(--text-color);
            text-align: center;
        }

        .telegram-preview {
            flex: 1;
            background-color: #1e2c3d;
            border-radius: 10px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .telegram-header {
            background-color: #273348;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            color: white;
            font-weight: 600;
            text-align: center;
        }

        .message {
            background-color: #2b3b52;
            color: white;
            padding: 8px 12px;
            border-radius: 12px;
            margin-bottom: 10px;
            max-width: 80%;
            align-self: flex-start;
        }

        .message.user {
            background-color: #0088cc;
            align-self: flex-end;
        }

        /* Auth Forms */
        .auth-form-container {
            display: none;
            max-width: 400px;
            margin: 50px auto;
            background-color: var(--card-color);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
        }

        .auth-form-container.active {
            display: block;
        }

        .auth-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            text-align: center;
            color: var(--text-color);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 136, 204, 0.2);
        }

        .form-footer {
            text-align: center;
            margin-top: 20px;
            color: var(--text-secondary);
        }

        .form-footer a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
        }

        .form-footer a:hover {
            text-decoration: underline;
        }

        .oauth-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .oauth-btn {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--bg-color);
            color: var(--text-color);
            cursor: pointer;
            transition: var(--transition);
        }

        .oauth-btn:hover {
            background-color: var(--border-color);
        }

        .oauth-btn i {
            margin-right: 8px;
        }

        /* Theme Toggle */
        .theme-toggle {
            background: none;
            border: none;
            font-size: 1.2rem;
            color: var(--text-color);
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        .theme-toggle:hover {
            background-color: var(--bg-color);
        }

        /* Token Integration */
        .token-integration {
            background-color: var(--card-color);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            max-width: 600px;
            margin: 0 auto;
        }

        .token-instruction {
            background-color: rgba(0, 136, 204, 0.1);
            border-left: 4px solid var(--primary-color);
            padding: 15px;
            margin-bottom: 25px;
            border-radius: 0 8px 8px 0;
        }

        .token-form {
            margin-top: 20px;
        }

        .input-with-icon {
            position: relative;
        }

        .input-with-icon input {
            padding-right: 50px;
        }

        .toggle-visibility {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .constructor-layout {
                flex-direction: column;
                height: auto;
            }

            .components-panel, .preview-panel {
                width: 100%;
            }

            .dashboard-content {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
            }
        }

        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 15px;
            }

            .nav-links {
                width: 100%;
                justify-content: center;
            }

            .hero h1 {
                font-size: 2.2rem;
            }

            .bot-list {
                grid-template-columns: 1fr;
            }
        }

        /* Utility Classes */
        .hidden {
            display: none !important;
        }

        .visible {
            display: block !important;
        }

        .text-center {
            text-align: center;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .alert {
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-success {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success-color);
            border-left: 4px solid var(--success-color);
        }

        .alert-info {
            background-color: rgba(0, 136, 204, 0.1);
            color: var(--primary-color);
            border-left: 4px solid var(--primary-color);
        }

        .alert-warning {
            background-color: rgba(255, 193, 7, 0.1);
            color: var(--warning-color);
            border-left: 4px solid var(--warning-color);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Header & Navigation -->
    <header>
        <div class="container">
            <nav class="navbar">
                <div class="logo">
                    <i class="fas fa-robot"></i>
                    <span>BotCreator</span>
                </div>
                <div class="nav-links">
                    <a href="#features">Возможности</a>
                    <a href="#pricing">Тарифы</a>
                    <a href="#docs">Документация</a>
                    <button class="theme-toggle" id="themeToggle">
                        <i class="fas fa-moon"></i>
                    </button>
                    <div id="authButtons">
                        <a href="#" class="btn btn-outline" id="loginBtn">Войти</a>
                        <a href="#" class="btn btn-primary" id="registerBtn">Зарегистрироваться</a>
                    </div>
                    <div id="userMenu" class="hidden">
                        <span id="userEmail" style="margin-right: 15px; font-weight: 500;"></span>
                        <a href="#" class="btn btn-outline btn-small" id="logoutBtn">Выход</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section (Public) -->
    <section class="hero" id="publicPage">
        <div class="container">
            <h1>Создавайте Telegram-ботов без программирования</h1>
            <p>Интуитивный конструктор для создания функциональных Telegram-ботов с помощью drag-and-drop интерфейса. Начните бесплатно!</p>
            <div class="hero-buttons">
                <a href="#" class="btn btn-primary" id="heroRegisterBtn">Начать создание</a>
                <a href="#" class="btn btn-outline">Узнать больше</a>
            </div>
        </div>
    </section>

    <!-- Login Form -->
    <div class="container">
        <div class="auth-form-container" id="loginForm">
            <h2 class="auth-title">Вход в аккаунт</h2>
            <form id="loginFormElement">
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" class="form-control" placeholder="Ваш email" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Пароль</label>
                    <input type="password" id="loginPassword" class="form-control" placeholder="Ваш пароль" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Войти</button>
            </form>
            <div class="form-footer">
                <p>Нет аккаунта? <a href="#" id="switchToRegister">Зарегистрироваться</a></p>
                <p><a href="#" id="forgotPassword">Забыли пароль?</a></p>
            </div>
            <div class="oauth-buttons">
                <button class="oauth-btn">
                    <i class="fab fa-google"></i> Google
                </button>
                <button class="oauth-btn">
                    <i class="fab fa-github"></i> GitHub
                </button>
            </div>
        </div>

        <!-- Register Form -->
        <div class="auth-form-container" id="registerForm">
            <h2 class="auth-title">Регистрация</h2>
            <form id="registerFormElement">
                <div class="form-group">
                    <label for="registerEmail">Email</label>
                    <input type="email" id="registerEmail" class="form-control" placeholder="Ваш email" required>
                </div>
                <div class="form-group">
                    <label for="registerPassword">Пароль</label>
                    <input type="password" id="registerPassword" class="form-control" placeholder="Придумайте пароль" required>
                </div>
                <div class="form-group">
                    <label for="confirmPassword">Подтвердите пароль</label>
                    <input type="password" id="confirmPassword" class="form-control" placeholder="Повторите пароль" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Зарегистрироваться</button>
            </form>
            <div class="form-footer">
                <p>Уже есть аккаунт? <a href="#" id="switchToLogin">Войти</a></p>
            </div>
            <div class="oauth-buttons">
                <button class="oauth-btn">
                    <i class="fab fa-google"></i> Google
                </button>
                <button class="oauth-btn">
                    <i class="fab fa-github"></i> GitHub
                </button>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <section class="dashboard" id="dashboard">
        <div class="container">
            <div class="dashboard-header">
                <h2 class="dashboard-title">Личный кабинет</h2>
                <button class="btn btn-primary" id="createBotBtn">
                    <i class="fas fa-plus"></i> Создать нового бота
                </button>
            </div>
            
            <div class="dashboard-content">
                <!-- Sidebar -->
                <div class="sidebar">
                    <ul class="sidebar-menu">
                        <li><a href="#" class="active" id="menuMyBots"><i class="fas fa-robot"></i> Мои боты</a></li>
                        <li><a href="#" id="menuSettings"><i class="fas fa-cog"></i> Настройки аккаунта</a></li>
                        <li><a href="#" id="menuDocs"><i class="fas fa-book"></i> Документация</a></li>
                        <li><a href="#" id="menuLogout"><i class="fas fa-sign-out-alt"></i> Выход</a></li>
                    </ul>
                </div>
                
                <!-- Main Content -->
                <div class="main-content">
                    <!-- My Bots Tab -->
                    <div class="tab-content active" id="myBotsTab">
                        <div class="bot-list" id="botList">
                            <!-- Боты будут загружаться здесь -->
                        </div>
                        
                        <div class="alert alert-info" id="noBotsMessage">
                            <p>У вас пока нет созданных ботов. Нажмите "Создать нового бота", чтобы начать.</p>
                        </div>
                    </div>
                    
                    <!-- Settings Tab -->
                    <div class="tab-content" id="settingsTab">
                        <div class="token-integration">
                            <h3>Настройки аккаунта</h3>
                            <div class="form-group mt-20">
                                <label for="userName">Имя пользователя</label>
                                <input type="text" id="userName" class="form-control" placeholder="Ваше имя">
                            </div>
                            <div class="form-group">
                                <label for="userEmailSettings">Email</label>
                                <input type="email" id="userEmailSettings" class="form-control" placeholder="Ваш email">
                            </div>
                            <button class="btn btn-primary mt-20">Сохранить изменения</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Bot Constructor -->
    <section class="constructor" id="constructor">
        <div class="container">
            <div class="constructor-header">
                <h2 class="constructor-title" id="constructorBotName">Конструктор бота</h2>
                <div>
                    <button class="btn btn-outline" id="backToDashboard">
                        <i class="fas fa-arrow-left"></i> Назад
                    </button>
                    <button class="btn btn-success" id="saveBotBtn">
                        <i class="fas fa-save"></i> Сохранить
                    </button>
                    <button class="btn btn-primary" id="launchBotBtn">
                        <i class="fas fa-play"></i> Запустить бота
                    </button>
                </div>
            </div>
            
            <div class="constructor-layout">
                <!-- Components Panel -->
                <div class="components-panel">
                    <div class="component-category">
                        <h4>Команды</h4>
                        <div class="component-item" data-type="command" data-command="/start">Команда /start</div>
                        <div class="component-item" data-type="command" data-command="/help">Команда /help</div>
                        <div class="component-item" data-type="command" data-command="/menu">Команда /menu</div>
                    </div>
                    
                    <div class="component-category">
                        <h4>Ответы</h4>
                        <div class="component-item" data-type="text">Текстовый ответ</div>
                        <div class="component-item" data-type="media">Медиа (фото/видео)</div>
                        <div class="component-item" data-type="document">Документ</div>
                    </div>
                    
                    <div class="component-category">
                        <h4>Клавиатуры</h4>
                        <div class="component-item" data-type="reply-keyboard">Reply-клавиатура</div>
                        <div class="component-item" data-type="inline-keyboard">Inline-клавиатура</div>
                    </div>
                    
                    <div class="component-category">
                        <h4>Логика</h4>
                        <div class="component-item" data-type="condition">Условие</div>
                        <div class="component-item" data-type="trigger">Триггер по словам</div>
                        <div class="component-item" data-type="variable">Переменная</div>
                    </div>
                </div>
                
                <!-- Workspace -->
                <div class="workspace" id="workspace">
                    <div class="workspace-placeholder" id="workspacePlaceholder">
                        <i class="fas fa-puzzle-piece"></i>
                        <h3>Перетащите сюда компоненты</h3>
                        <p>Начните создание бота, перетаскивая компоненты из панели слева</p>
                    </div>
                    <div id="workspaceContent" class="hidden">
                        <!-- Компоненты будут добавляться сюда -->
                    </div>
                </div>
                
                <!-- Preview Panel -->
                <div class="preview-panel">
                    <h3 class="preview-title">Предпросмотр бота</h3>
                    <div class="telegram-preview">
                        <div class="telegram-header">Telegram Bot Preview</div>
                        <div class="message">Добро пожаловать! Я ваш новый бот. Чем могу помочь?</div>
                        <div class="message user">/start</div>
                        <div class="message">Привет! Я бот, созданный в BotCreator. Используйте /help для списка команд.</div>
                    </div>
                    <button class="btn btn-outline mt-20" id="testBotBtn">
                        <i class="fas fa-bolt"></i> Протестировать
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Token Integration Modal -->
    <div class="container">
        <div class="auth-form-container" id="tokenIntegrationForm">
            <h2 class="auth-title">Интеграция с Telegram</h2>
            <div class="token-instruction">
                <p><strong>Как получить токен:</strong></p>
                <ol>
                    <li>Откройте Telegram и найдите @BotFather</li>
                    <li>Отправьте команду /newbot и следуйте инструкциям</li>
                    <li>После создания бота, BotFather предоставит вам API-токен</li>
                    <li>Скопируйте токен и вставьте в поле ниже</li>
                </ol>
            </div>
            
            <div class="token-form">
                <div class="form-group">
                    <label for="botToken">Токен Telegram-бота</label>
                    <div class="input-with-icon">
                        <input type="password" id="botToken" class="form-control" placeholder="Введите ваш токен">
                        <button type="button" class="toggle-visibility" id="toggleTokenVisibility">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
                <button class="btn btn-primary" id="validateTokenBtn">
                    <i class="fas fa-check"></i> Проверить и сохранить токен
                </button>
            </div>
            
            <div class="form-footer">
                <button class="btn btn-outline" id="backToConstructor">Назад к конструктору</button>
            </div>
        </div>
    </div>

    <script>
        // Состояние приложения
        const state = {
            isAuthenticated: false,
            currentUser: null,
            currentBot: null,
            bots: [
                { id: 1, name: "Мой первый бот", status: "active", users: 15, messages: 230, lastUpdated: "2023-10-15" },
                { id: 2, name: "Поддержка клиентов", status: "inactive", users: 42, messages: 1250, lastUpdated: "2023-10-10" }
            ],
            isDarkTheme: false
        };

        // DOM элементы
        const elements = {
            publicPage: document.getElementById('publicPage'),
            authButtons: document.getElementById('authButtons'),
            userMenu: document.getElementById('userMenu'),
            userEmail: document.getElementById('userEmail'),
            loginBtn: document.getElementById('loginBtn'),
            registerBtn: document.getElementById('registerBtn'),
            logoutBtn: document.getElementById('logoutBtn'),
            heroRegisterBtn: document.getElementById('heroRegisterBtn'),
            loginForm: document.getElementById('loginForm'),
            registerForm: document.getElementById('registerForm'),
            dashboard: document.getElementById('dashboard'),
            constructor: document.getElementById('constructor'),
            tokenIntegrationForm: document.getElementById('tokenIntegrationForm'),
            themeToggle: document.getElementById('themeToggle'),
            createBotBtn: document.getElementById('createBotBtn'),
            botList: document.getElementById('botList'),
            noBotsMessage: document.getElementById('noBotsMessage'),
            menuMyBots: document.getElementById('menuMyBots'),
            menuSettings: document.getElementById('menuSettings'),
            myBotsTab: document.getElementById('myBotsTab'),
            settingsTab: document.getElementById('settingsTab'),
            backToDashboard: document.getElementById('backToDashboard'),
            saveBotBtn: document.getElementById('saveBotBtn'),
            launchBotBtn: document.getElementById('launchBotBtn'),
            workspacePlaceholder: document.getElementById('workspacePlaceholder'),
            workspaceContent: document.getElementById('workspaceContent'),
            botToken: document.getElementById('botToken'),
            toggleTokenVisibility: document.getElementById('toggleTokenVisibility'),
            validateTokenBtn: document.getElementById('validateTokenBtn'),
            backToConstructor: document.getElementById('backToConstructor'),
            switchToLogin: document.getElementById('switchToLogin'),
            switchToRegister: document.getElementById('switchToRegister'),
            loginFormElement: document.getElementById('loginFormElement'),
            registerFormElement: document.getElementById('registerFormElement')
        };

        // Инициализация приложения
        function initApp() {
            // Проверка темы
            const savedTheme = localStorage.getItem('botCreatorTheme');
            if (savedTheme === 'dark') {
                enableDarkTheme();
            }
            
            // Проверка авторизации (для демо)
            const savedUser = localStorage.getItem('botCreatorUser');
            if (savedUser) {
                state.currentUser = JSON.parse(savedUser);
                state.isAuthenticated = true;
                showDashboard();
            }
            
            renderBotList();
            setupEventListeners();
        }

        // Настройка обработчиков событий
        function setupEventListeners() {
            // Навигация
            elements.loginBtn.addEventListener('click', (e) => {
                e.preventDefault();
                showLoginForm();
            });
            
            elements.registerBtn.addEventListener('click', (e) => {
                e.preventDefault();
                showRegisterForm();
            });
            
            elements.heroRegisterBtn.addEventListener('click', (e) => {
                e.preventDefault();
                if (state.isAuthenticated) {
                    showConstructor();
                } else {
                    showRegisterForm();
                }
            });
            
            elements.logoutBtn.addEventListener('click', (e) => {
                e.preventDefault();
                logout();
            });
            
            elements.themeToggle.addEventListener('click', toggleTheme);
            
            // Формы авторизации
            elements.switchToLogin.addEventListener('click', (e) => {
                e.preventDefault();
                showLoginForm();
            });
            
            elements.switchToRegister.addEventListener('click', (e) => {
                e.preventDefault();
                showRegisterForm();
            });
            
            elements.loginFormElement.addEventListener('submit', (e) => {
                e.preventDefault();
                handleLogin();
            });
            
            elements.registerFormElement.addEventListener('submit', (e) => {
                e.preventDefault();
                handleRegister();
            });
            
            // Дашборд
            elements.createBotBtn.addEventListener('click', () => {
                showTokenIntegration();
            });
            
            elements.menuMyBots.addEventListener('click', (e) => {
                e.preventDefault();
                showTab('myBotsTab');
                setActiveMenu(elements.menuMyBots);
            });
            
            elements.menuSettings.addEventListener('click', (e) => {
                e.preventDefault();
                showTab('settingsTab');
                setActiveMenu(elements.menuSettings);
            });
            
            // Конструктор
            elements.backToDashboard.addEventListener('click', showDashboard);
            elements.saveBotBtn.addEventListener('click', saveBot);
            elements.launchBotBtn.addEventListener('click', launchBot);
            
            // Интеграция с токеном
            elements.toggleTokenVisibility.addEventListener('click', toggleTokenVisibility);
            elements.validateTokenBtn.addEventListener('click', validateToken);
            elements.backToConstructor.addEventListener('click', showConstructor);
            
            // Drag and drop для конструктора
            setupDragAndDrop();
        }

        // Показать форму входа
        function showLoginForm() {
            hideAllSections();
            elements.loginForm.classList.add('active');
        }

        // Показать форму регистрации
        function showRegisterForm() {
            hideAllSections();
            elements.registerForm.classList.add('active');
        }

        // Показать дашборд
        function showDashboard() {
            hideAllSections();
            elements.dashboard.style.display = 'block';
            elements.publicPage.style.display = 'none';
            
            if (state.isAuthenticated) {
                elements.authButtons.classList.add('hidden');
                elements.userMenu.classList.remove('hidden');
                elements.userEmail.textContent = state.currentUser.email;
            }
            
            showTab('myBotsTab');
            setActiveMenu(elements.menuMyBots);
        }

        // Показать конструктор
        function showConstructor() {
            hideAllSections();
            elements.constructor.style.display = 'block';
        }

        // Показать интеграцию с токеном
        function showTokenIntegration() {
            hideAllSections();
            elements.tokenIntegrationForm.classList.add('active');
        }

        // Скрыть все секции
        function hideAllSections() {
            elements.publicPage.style.display = 'none';
            elements.loginForm.classList.remove('active');
            elements.registerForm.classList.remove('active');
            elements.dashboard.style.display = 'none';
            elements.constructor.style.display = 'none';
            elements.tokenIntegrationForm.classList.remove('active');
        }

        // Показать таб
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
        }

        // Установить активное меню
        function setActiveMenu(activeItem) {
            document.querySelectorAll('.sidebar-menu a').forEach(item => {
                item.classList.remove('active');
            });
            activeItem.classList.add('active');
        }

        // Обработка входа
        function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            // Демо-авторизация
            if (email && password) {
                state.isAuthenticated = true;
                state.currentUser = { email, name: email.split('@')[0] };
                localStorage.setItem('botCreatorUser', JSON.stringify(state.currentUser));
                
                showDashboard();
                showNotification('Вход выполнен успешно!', 'success');
            } else {
                showNotification('Пожалуйста, заполните все поля', 'error');
            }
        }

        // Обработка регистрации
        function handleRegister() {
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (!email || !password || !confirmPassword) {
                showNotification('Пожалуйста, заполните все поля', 'error');
                return;
            }
            
            if (password !== confirmPassword) {
                showNotification('Пароли не совпадают', 'error');
                return;
            }
            
            // Демо-регистрация
            state.isAuthenticated = true;
            state.currentUser = { email, name: email.split('@')[0] };
            localStorage.setItem('botCreatorUser', JSON.stringify(state.currentUser));
            
            showDashboard();
            showNotification('Регистрация прошла успешно!', 'success');
        }

        // Выход
        function logout() {
            state.isAuthenticated = false;
            state.currentUser = null;
            localStorage.removeItem('botCreatorUser');
            
            elements.authButtons.classList.remove('hidden');
            elements.userMenu.classList.add('hidden');
            
            hideAllSections();
            elements.publicPage.style.display = 'block';
            
            showNotification('Вы вышли из аккаунта', 'info');
        }

        // Переключение темы
        function toggleTheme() {
            if (state.isDarkTheme) {
                disableDarkTheme();
            } else {
                enableDarkTheme();
            }
        }

        // Включить темную тему
        function enableDarkTheme() {
            document.body.classList.add('dark-theme');
            elements.themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            state.isDarkTheme = true;
            localStorage.setItem('botCreatorTheme', 'dark');
        }

        // Отключить темную тему
        function disableDarkTheme() {
            document.body.classList.remove('dark-theme');
            elements.themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
            state.isDarkTheme = false;
            localStorage.setItem('botCreatorTheme', 'light');
        }

        // Отрисовка списка ботов
        function renderBotList() {
            if (state.bots.length === 0) {
                elements.noBotsMessage.classList.remove('hidden');
                elements.botList.innerHTML = '';
                return;
            }
            
            elements.noBotsMessage.classList.add('hidden');
            elements.botList.innerHTML = '';
            
            state.bots.forEach(bot => {
                const botCard = document.createElement('div');
                botCard.className = 'bot-card';
                botCard.innerHTML = `
                    <div class="bot-card-header">
                        <h3 class="bot-name">${bot.name}</h3>
                        <span class="bot-status ${bot.status}"></span>
                        <span>${bot.status === 'active' ? 'Активен' : 'Неактивен'}</span>
                    </div>
                    <p>Последнее обновление: ${bot.lastUpdated}</p>
                    <div class="bot-stats">
                        <span><i class="fas fa-users"></i> ${bot.users} пользователей</span>
                        <span><i class="fas fa-comments"></i> ${bot.messages} сообщений</span>
                    </div>
                    <div style="margin-top: 15px; display: flex; gap: 10px;">
                        <button class="btn btn-outline btn-small edit-bot" data-id="${bot.id}">
                            <i class="fas fa-edit"></i> Редактировать
                        </button>
                        <button class="btn btn-${bot.status === 'active' ? 'danger' : 'success'} btn-small toggle-bot" data-id="${bot.id}">
                            <i class="fas fa-${bot.status === 'active' ? 'stop' : 'play'}"></i> ${bot.status === 'active' ? 'Остановить' : 'Запустить'}
                        </button>
                    </div>
                `;
                
                elements.botList.appendChild(botCard);
            });
            
            // Добавляем обработчики для кнопок ботов
            document.querySelectorAll('.edit-bot').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const botId = parseInt(e.target.closest('button').dataset.id);
                    const bot = state.bots.find(b => b.id === botId);
                    if (bot) {
                        state.currentBot = bot;
                        showConstructor();
                    }
                });
            });
            
            document.querySelectorAll('.toggle-bot').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const botId = parseInt(e.target.closest('button').dataset.id);
                    const bot = state.bots.find(b => b.id === botId);
                    if (bot) {
                        bot.status = bot.status === 'active' ? 'inactive' : 'active';
                        renderBotList();
                        showNotification(`Бот ${bot.name} ${bot.status === 'active' ? 'запущен' : 'остановлен'}`, 'success');
                    }
                });
            });
        }

        // Настройка drag and drop
        function setupDragAndDrop() {
            const componentItems = document.querySelectorAll('.component-item');
            const workspace = elements.workspace;
            
            componentItems.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', JSON.stringify({
                        type: item.dataset.type,
                        command: item.dataset.command
                    }));
                });
            });
            
            workspace.addEventListener('dragover', (e) => {
                e.preventDefault();
                workspace.style.backgroundColor = 'rgba(0, 136, 204, 0.05)';
            });
            
            workspace.addEventListener('dragleave', () => {
                workspace.style.backgroundColor = '';
            });
            
            workspace.addEventListener('drop', (e) => {
                e.preventDefault();
                workspace.style.backgroundColor = '';
                
                const data = JSON.parse(e.dataTransfer.getData('text/plain'));
                addComponentToWorkspace(data.type, data.command);
            });
        }

        // Добавление компонента в рабочую область
        function addComponentToWorkspace(type, command = '') {
            elements.workspacePlaceholder.classList.add('hidden');
            elements.workspaceContent.classList.remove('hidden');
            
            const component = document.createElement('div');
            component.className = 'component-item';
            component.style.marginBottom = '10px';
            component.style.cursor = 'default';
            
            let content = '';
            switch(type) {
                case 'command':
                    content = `Команда: <strong>${command}</strong>`;
                    break;
                case 'text':
                    content = 'Текстовый ответ';
                    break;
                case 'media':
                    content = 'Медиа-файл (фото/видео)';
                    break;
                case 'reply-keyboard':
                    content = 'Reply-клавиатура';
                    break;
                case 'inline-keyboard':
                    content = 'Inline-клавиатура';
                    break;
                case 'condition':
                    content = 'Условие (если/иначе)';
                    break;
                case 'trigger':
                    content = 'Триггер по ключевым словам';
                    break;
                default:
                    content = 'Компонент';
            }
            
            component.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span>${content}</span>
                    <button class="btn btn-outline btn-small" style="padding: 3px 8px;">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>
            `;
            
            elements.workspaceContent.appendChild(component);
            showNotification('Компонент добавлен в рабочую область', 'info');
        }

        // Сохранение бота
        function saveBot() {
            showNotification('Конфигурация бота сохранена', 'success');
        }

        // Запуск бота
        function launchBot() {
            showNotification('Бот успешно запущен!', 'success');
            setTimeout(() => {
                showDashboard();
            }, 1500);
        }

        // Переключение видимости токена
        function toggleTokenVisibility() {
            const tokenField = elements.botToken;
            const icon = elements.toggleTokenVisibility.querySelector('i');
            
            if (tokenField.type === 'password') {
                tokenField.type = 'text';
                icon.className = 'fas fa-eye-slash';
            } else {
                tokenField.type = 'password';
                icon.className = 'fas fa-eye';
            }
        }

        // Валидация токена
        function validateToken() {
            const token = elements.botToken.value.trim();
            
            if (!token) {
                showNotification('Введите токен бота', 'error');
                return;
            }
            
            // Демо-валидация
            if (token.length < 10) {
                showNotification('Неверный формат токена', 'error');
                return;
            }
            
            showNotification('Токен успешно проверен и сохранен!', 'success');
            setTimeout(() => {
                showConstructor();
            }, 1500);
        }

        // Показать уведомление
        function showNotification(message, type = 'info') {
            // Удаляем предыдущие уведомления
            const existingAlert = document.querySelector('.notification-alert');
            if (existingAlert) {
                existingAlert.remove();
            }
            
            // Создаем новое уведомление
            const alert = document.createElement('div');
            alert.className = `notification-alert alert alert-${type}`;
            alert.textContent = message;
            alert.style.position = 'fixed';
            alert.style.top = '20px';
            alert.style.right = '20px';
            alert.style.zIndex = '9999';
            alert.style.maxWidth = '300px';
            
            document.body.appendChild(alert);
            
            // Автоматически скрываем через 3 секунды
            setTimeout(() => {
                if (alert.parentNode) {
                    alert.remove();
                }
            }, 3000);
        }

        // Инициализация приложения после загрузки DOM
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
